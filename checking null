-- Menghitung jumlah nilai NULL di setiap kolom untuk setiap baris dalam tabel users
WITH all_columns AS (
  SELECT
    id, first_name, last_name, email, age, gender,
    state, street_address, postal_code, city, country,
    latitude, longitude, traffic_source, created_at
  FROM
    `bigquery-public-data.thelook_ecommerce.users`
)

SELECT
  'Total_NULLs' AS column_name,
  COUNTIF(id IS NULL) +
  COUNTIF(first_name IS NULL) +
  COUNTIF(last_name IS NULL) +
  COUNTIF(email IS NULL) +
  COUNTIF(age IS NULL) +
  COUNTIF(gender IS NULL) +
  COUNTIF(state IS NULL) +
  COUNTIF(street_address IS NULL) +
  COUNTIF(postal_code IS NULL) +
  COUNTIF(city IS NULL) +
  COUNTIF(country IS NULL) +
  COUNTIF(latitude IS NULL) +
  COUNTIF(longitude IS NULL) +
  COUNTIF(traffic_source IS NULL) +
  COUNTIF(created_at IS NULL) AS null_count_total_rows
FROM
  all_columns;
